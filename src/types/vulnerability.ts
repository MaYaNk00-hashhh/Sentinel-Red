export type Severity = 'critical' | 'high' | 'medium' | 'low' | 'info'
export type VulnType = 'IDOR' | 'Logic Bypass' | 'Auth Bypass' | 'Business Logic' | 'Input Validation' | 'Other'

export interface Vulnerability {
  id: string
  title: string
  severity: Severity
  type: VulnType
  description: string
  impact: string
  exploit_complexity: 'low' | 'medium' | 'high'
  cvss_score?: number
  scan_id: string
  project_id?: string
  project_name?: string
  discovered_at: string
  attack_chain: AttackStep[]
  affected_endpoints: string[]
  recommended_fixes: string[]
  evidence?: {
    request: {
      method: string
      url: string
      headers: Record<string, string>
      body: unknown
    }
    response: {
      status: number
      headers: Record<string, string>
      body: unknown
    }
  }
}

export interface AttackStep {
  step: number
  description: string
  action: string
  payload?: unknown
  endpoint?: string
  expected_outcome: string
  actual_outcome: string
}

export interface VulnerabilityFilter {
  severity?: Severity
  type?: VulnType
  scanId?: string
}
